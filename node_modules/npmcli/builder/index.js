'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.start = undefined;

var _path = require('path');

var _ramda = require('ramda');

var _inquirer = require('inquirer');

var _menus = require('../menus.json');

var _menus2 = _interopRequireDefault(_menus);

var _paths = require('../helper/paths');

var _runner = require('../helper/runner');

var _cmd = require('../helper/cmd');

var _menu = require('../helper/menu');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var start = exports.start = function start(MODULE) {
	var _ref = !MODULE ? _menus2.default[0] : { name: MODULE };

	var name = _ref.name;

	var menuInstance = loadMenu(name);
	var menuStructure = findObject(_menus2.default, 'name', name);
	var menu = menuInstance.menu;
	var choices = menuInstance.choices;


	var selectedMenu = void 0;
	return (0, _inquirer.prompt)(menu).then(function (_ref2) {
		var menu = _ref2.menu;

		selectedMenu = menu;
		return (0, _menu.selectedChoice)(choices)(menu);
	}).then(function (_ref3) {
		var file = _ref3.file;
		var value = _ref3.value;

		return menuStructure.submenus ? (0, _menu.loadSelectedModule)(file) : (0, _cmd.executeScript)(value);
	}).then(function () {
		var _findObject = findObject(choices, 'value', selectedMenu);

		var file = _findObject.file;

		start(file);
	}).catch(console.log);
};

function loadMenu(name) {
	return require((0, _path.join)(_paths.menus, name));
}

function findObject(array, key, value) {
	return array.find(function (element) {
		return element[key] === value;
	});
}